customElements.get("sticky-atc")||customElements.define("sticky-atc",class extends HTMLElement{constructor(){super(),this.selectors={prodTitle:".m-sticky-addtocart--title",mainImage:".m-sticky-addtocart--image",addToCart:".m-add-to-cart",buyNowBtn:".m-product-dynamic-checkout",variantIdSelect:'[name="id"]',foxkitBtn:".foxkit-button"},this.hasCustomFields=!!document.querySelector(".m-main-product__info .m-product-custom-field")}connectedCallback(){this.container=this.closest(".m-sticky-addtocart"),this.mainProductForm=document.querySelector(".m-product-form--main"),this.mainProductInfo=document.querySelector(".m-main-product__info"),this.mainAddToCart=this.mainProductForm.querySelector(this.selectors.addToCart),this.mainDynamicCheckout=this.mainProductForm.querySelector(this.selectors.buyNowBtn),this.productId=this.dataset.productId,this.mainProductFormHeight=this.mainProductForm.offsetHeight,this.stickyHeaderHeight=document.querySelector(".m-header__top-wrapper").offsetHeight,this.domNodes=queryDomNodes(this.selectors,this.container),this.variantData=this.getVariantData(),this.init(),this.setStickyAddToCartHeight(),this.addEventListener("change",()=>{const selectedVariantId=this.querySelector(this.selectors.variantIdSelect).value;this.currentVariant=this.variantData.find(variant=>variant.id===Number(selectedVariantId)),this.updateButton(!0,"",!1),this.currentVariant?this.updateButton(!this.currentVariant.available,window.MinimogStrings.soldOut):this.updateButton(!0,"",!0)}),document.addEventListener("matchMobile",()=>{this.setStickyAddToCartHeight()}),document.addEventListener("unmatchMobile",()=>{this.setStickyAddToCartHeight()})}getVariantData(){return this.variantData=this.variantData||JSON.parse(this.container.querySelector('[type="application/json"]').textContent),this.variantData}init(){if(!this.mainAddToCart&&!this.mainDynamicCheckout){this.container.style.setProperty("--m-translate-y",0);return}const{prodTitle,mainImage,addToCart,buyNowBtn,foxkitBtn}=this.domNodes;buyNowBtn&&(this.enable_dynamic_checkout=!0);let headerHeight=this.mainProductFormHeight-40;document.querySelector('[data-sticky-type="always"]')&&(headerHeight=this.mainProductFormHeight-this.stickyHeaderHeight-40);const rootMargin=`${headerHeight}px 0px 0px 0px`;"IntersectionObserver"in window&&(this.observer=new IntersectionObserver(entries=>{entries.forEach(entry=>{entry.intersectionRatio!==1?this.container.style.setProperty("--m-translate-y",0):this.container.style.setProperty("--m-translate-y","100%"),document.documentElement.classList[entry.intersectionRatio!=1?"remove":"add"]("stick-atc-show")})},{threshold:1,rootMargin})),prodTitle.addEventListener("click",()=>__scrollToTop()),mainImage.addEventListener("click",()=>__scrollToTop()),this.hasCustomFields&&(addToCart.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),__scrollToTop(this.mainProductForm,()=>this.mainAddToCart.click())}),buyNowBtn&&buyNowBtn.addEventListener("click",e=>{validateForm(this.mainProductInfo).length>0&&(e.preventDefault(),e.stopPropagation(),__scrollToTop(this.mainProductForm,()=>this.mainDynamicCheckout.click()))},!0),foxkitBtn&&foxkitBtn.addEventListener("click",e=>{e.preventDefault(),__scrollToTop(this.mainProductForm,()=>this.mainAddToCart.click())})),this.setObserveTarget(),this.syncWithMainProductForm()}setObserveTarget(){this.observer&&(this.observer.observe(this.mainProductForm),this.observeTarget=this.mainProductForm)}checkDevice(e){const sectionHeight=this.clientHeight+"px";document.documentElement.style.setProperty("--f-sticky-atc-bar-height",sectionHeight)}updateButton(disable=!0,text,modifyClass=!0){const productForm=this.querySelector(".sticky-atc-form");if(!productForm)return;const addButton=productForm.querySelector('[name="add"]'),addButtonText=productForm.querySelector('[name="add"] > .m-add-to-cart--text');addButton&&(disable?(addButton.setAttribute("disabled","disabled"),text&&(addButtonText.textContent=text)):(addButton.removeAttribute("disabled"),addButton.classList.remove("disabled"),addButtonText.textContent=window.MinimogStrings.addToCart))}syncWithMainProductForm(){const variantInput=this.querySelector('[name="id"]');window.MinimogEvents.subscribe(`${this.productId}__VARIANT_CHANGE`,async variant=>{variantInput.value=variant.id})}setStickyAddToCartHeight(){document.documentElement.style.setProperty("--f-sticky-atc-bar-height",this.offsetHeight+"px"),window.MinimogSettings.stickyAddToCartHeight=this.offsetHeight}});
//# sourceMappingURL=/cdn/shop/t/5/assets/sticky-atc.js.map?v=87165621776427305041728918271
